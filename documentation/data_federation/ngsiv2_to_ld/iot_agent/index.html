
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://citcom-vrain.github.io/documentation/data_federation/ngsiv2_to_ld/iot_agent/">
      
      
        <link rel="prev" href="../lepus/">
      
      
        <link rel="next" href="../../../data_space_connectors/">
      
      
      <link rel="icon" href="../../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>FIWARE IoT-Agent - CitCom.ai | VRAIN</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/neoteroi-mkdocs.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fiware-iot-agent" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="CitCom.ai | VRAIN" class="md-header__button md-logo" aria-label="CitCom.ai | VRAIN" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CitCom.ai | VRAIN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FIWARE IoT-Agent
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/CitCom-VRAIN/CitCom-VRAIN.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CitCom-VRAIN/CitCom-VRAIN.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="CitCom.ai | VRAIN" class="md-nav__button md-logo" aria-label="CitCom.ai | VRAIN" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    CitCom.ai | VRAIN
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CitCom-VRAIN/CitCom-VRAIN.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CitCom-VRAIN/CitCom-VRAIN.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../welcome/" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.03 4.95 3.5 8.5c-3.33 3.31-3.33 8.69 0 12s8.69 3.33 12 0l6-6c1-.97 1-2.56 0-3.54-.1-.12-.23-.23-.37-.32l.37-.39c1-.97 1-2.56 0-3.54-.14-.16-.33-.3-.5-.41.38-.92.21-2.02-.54-2.77-.87-.87-2.22-.96-3.2-.28a2.517 2.517 0 0 0-3.88-.42l-2.51 2.51c-.09-.14-.2-.27-.32-.39a2.53 2.53 0 0 0-3.52 0m1.41 1.42c.2-.2.51-.2.71 0s.2.51 0 .71l-3.18 3.18a3 3 0 0 1 0 4.24l1.41 1.41a5.004 5.004 0 0 0 1.12-5.36l6.3-6.3c.2-.2.51-.2.7 0s.21.51 0 .71l-4.59 4.6 1.41 1.41 6.01-6.01c.2-.2.51-.2.71 0 .2.2.2.51 0 .71l-6.01 6.01 1.41 1.41 4.95-4.95c.2-.2.51-.2.71 0 .2.2.2.51 0 .71l-5.66 5.65 1.41 1.42 3.54-3.54c.2-.2.51-.2.71 0 .2.2.2.51 0 .71l-6 6.01c-2.54 2.54-6.65 2.54-9.19 0s-2.54-6.65 0-9.19l3.53-3.54M23 17c0 3.31-2.69 6-6 6v-1.5c2.5 0 4.5-2 4.5-4.5H23M1 7c0-3.31 2.69-6 6-6v1.5c-2.5 0-4.5 2-4.5 4.5H1Z"/></svg>
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../getting_started/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2S7 4 7 12c0 3.1.76 5.75 1.67 7.83A2 2 0 0 0 10.5 21h3a2 2 0 0 0 1.83-1.17C16.25 17.75 17 15.1 17 12c0-8-5-10-5-10m1.5 17h-3c-1-2.24-1.5-4.59-1.5-7 0-4.64 1.9-6.8 3-7.67 1.1.87 3 3.03 3 7.67 0 2.41-.5 4.76-1.5 7m6.5 3-3.86-1.55c.7-1.53 1.2-3.11 1.51-4.72m-9.79 4.72L4 22l2.35-6.27c.31 1.61.81 3.19 1.51 4.72M12 12c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2Z"/></svg>
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/nodes_countries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodes & Countries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/interoperability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interoperability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../getting_started/data_spaces/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data spaces
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Data spaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/data_spaces/join/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Join one
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/data_spaces/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy one
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/get_involved/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get involved
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../data_catalog/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 4H2V2h16v2m-4.96 6h-10l.6-3h12.72l.4 2c.74.04 1.45.19 2.13.46L18 5H2l-1 5v2h1v6h8.5c-.33-.8-.5-1.65-.5-2.5v.5H4v-4h6v3.5c0-1.66.64-3.33 1.9-4.6.36-.35.74-.65 1.14-.9m10.35 11L22 22.39l-3.12-3.07c-.69.43-1.51.68-2.38.68-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5c0 .88-.25 1.71-.69 2.4l3.08 3.1M19 15.5a2.5 2.5 0 0 0-5 0 2.5 2.5 0 0 0 5 0Z"/></svg>
  
  <span class="md-ellipsis">
    Data catalog
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data catalog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6m0 2h7v5h5v11H6V4m2 8v2h8v-2H8m0 4v2h5v-2H8Z"/></svg>
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Federation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Data Federation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NGSI-v2 to NGSI-LD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            NGSI-v2 to NGSI-LD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lepus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lepus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    FIWARE IoT-Agent
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    FIWARE IoT-Agent
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulation-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    <span class="md-ellipsis">
      Services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#before-continuing" class="md-nav__link">
    <span class="md-ellipsis">
      Before continuing...
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Before continuing...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#services-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Services checks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Services checks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongodb-connection" class="md-nav__link">
    <span class="md-ellipsis">
      MongoDB connection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communication-with-the-iot-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Communication with the IoT-Agents
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-access-to-the-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal access to the containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps-for-the-connection-between-brokers" class="md-nav__link">
    <span class="md-ellipsis">
      Steps for the connection between brokers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulations" class="md-nav__link">
    <span class="md-ellipsis">
      Simulations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-normalized-data-according-to-data-models" class="md-nav__link">
    <span class="md-ellipsis">
      Non-normalized data according to data-models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Non-normalized data according to data-models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#provisioning-of-a-group-of-services-iot-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Provisioning of a group of services (IoT-Agent)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Provisioning of a group of services (IoT-Agent)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aprovisionamiento-de-dispositivos-iot-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Aprovisionamiento de dispositivos (IoT-Agent)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aprovisionamiento de dispositivos (IoT-Agent)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-method" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-method-through-services" class="md-nav__link">
    <span class="md-ellipsis">
      Automated method (through services)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated method (through services)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks_1" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscription-of-orion-context-broker-v2-to-the-iot-agent-ld" class="md-nav__link">
    <span class="md-ellipsis">
      Subscription of Orion Context Broker V2 to the IoT-Agent LD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Subscription of Orion Context Broker V2 to the IoT-Agent LD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks_2" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_space_connectors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Space Connectors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Data Space Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_space_connectors/eclipse_mvd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eclipse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_space_connectors/fiware/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Fiware
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            Fiware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_space_connectors/fiware/legacy_1.X.X/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Legacy (v. 1.X.X)
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3_3_2" id="__nav_4_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Legacy (v. 1.X.X)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_3_2_2" id="__nav_4_3_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_3_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Deployments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_space_connectors/fiware/legacy_1.X.X/deployments/aws_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../data_space_connectors/fiware/legacy_1.X.X/deployments/local_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3_2_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../data_space_connectors/fiware/legacy_1.X.X/deployments/mvds_iaas/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Minimum Viable Data Space Infrastructure (MVDS-IaaS)
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_4_3_3_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Minimum Viable Data Space Infrastructure (MVDS-IaaS)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../services/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.5 15.5c0 1.11-.89 2-2 2s-2-.89-2-2 .9-2 2-2 2 .9 2 2m-9-2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.89 2-2-.89-2-2-2M23 15v3c0 .55-.45 1-1 1h-1v1c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2v-1H2c-.55 0-1-.45-1-1v-3c0-.55.45-1 1-1h1c0-3.87 3.13-7 7-7h1V5.73c-.6-.34-1-.99-1-1.73 0-1.1.9-2 2-2s2 .9 2 2c0 .74-.4 1.39-1 1.73V7h1c3.87 0 7 3.13 7 7h1c.55 0 1 .45 1 1m-2 1h-2v-2c0-2.76-2.24-5-5-5h-4c-2.76 0-5 2.24-5 5v2H3v1h2v3h14v-3h2v-1Z"/></svg>
  
  <span class="md-ellipsis">
    AI services
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            AI services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/waste_collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minimal Interoperable AI Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/wastecontainer_location_optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container Location Optimization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tef/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 23h-2v-2h2v2m4-2h-2v2h2v-2m-4-4h-2v2h2v-2m-8 4H5v2h2v-2m0-4H5v2h2v-2m12 0h-2v2h2v-2m-4-4h-2v2h2v-2m4 0h-2v2h2v-2m2-4a2 2 0 0 1 2 2v12h-2V11H11v12H9v-8H3v8H1v-8a2 2 0 0 1 2-2h6v-2a2 2 0 0 1 2-2V7a2 2 0 0 1 2-2h2V1h2v4h2a2 2 0 0 1 2 2v2m-2 0V7h-6v2h6Z"/></svg>
  
  <span class="md-ellipsis">
    TEF Nodes
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            TEF Nodes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../toolbox/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v10h20V10c0-1.1-.9-2-2-2M9 6h6v2H9V6m11 12H4v-3h2v1h2v-1h8v1h2v-1h2v3m-2-5v-1h-2v1H8v-1H6v1H4v-3h16v3h-2Z"/></svg>
  
  <span class="md-ellipsis">
    Toolbox
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Toolbox
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../toolbox/ai_toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Toolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../toolbox/mims_toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MIMs Toolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../toolbox/other_toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simulation-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    <span class="md-ellipsis">
      Services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#before-continuing" class="md-nav__link">
    <span class="md-ellipsis">
      Before continuing...
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Before continuing...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#services-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Services checks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Services checks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongodb-connection" class="md-nav__link">
    <span class="md-ellipsis">
      MongoDB connection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communication-with-the-iot-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Communication with the IoT-Agents
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terminal-access-to-the-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Terminal access to the containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#steps-for-the-connection-between-brokers" class="md-nav__link">
    <span class="md-ellipsis">
      Steps for the connection between brokers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulations" class="md-nav__link">
    <span class="md-ellipsis">
      Simulations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#non-normalized-data-according-to-data-models" class="md-nav__link">
    <span class="md-ellipsis">
      Non-normalized data according to data-models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Non-normalized data according to data-models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#provisioning-of-a-group-of-services-iot-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Provisioning of a group of services (IoT-Agent)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Provisioning of a group of services (IoT-Agent)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aprovisionamiento-de-dispositivos-iot-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Aprovisionamiento de dispositivos (IoT-Agent)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aprovisionamiento de dispositivos (IoT-Agent)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manual-method" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-method-through-services" class="md-nav__link">
    <span class="md-ellipsis">
      Automated method (through services)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automated method (through services)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks_1" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscription-of-orion-context-broker-v2-to-the-iot-agent-ld" class="md-nav__link">
    <span class="md-ellipsis">
      Subscription of Orion Context Broker V2 to the IoT-Agent LD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Subscription of Orion Context Broker V2 to the IoT-Agent LD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checks_2" class="md-nav__link">
    <span class="md-ellipsis">
      Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/CitCom-VRAIN/CitCom-VRAIN.github.io/edit/main/docs/documentation/data_federation/ngsiv2_to_ld/iot_agent.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="fiware-iot-agent">FIWARE IoT-Agent</h1>
<p><a class="md-button md-button--primary-light" href="https://github.com/CitCom-VRAIN/IoTAgent.NGSI-V2_to_NGSI-LD_Subscription">Repository <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></span></a></p>
<p>This section explains <strong>how to connect an NGSI-V2 broker with an NGSI-LD broker (<em>Fiware Orion</em>) through subscriptions to a <em>FIWARE IoT-Agent</em></strong>. This connection between brokers arises as an alternative to the use of <a href="../lepus/">FIWARE Lepus</a> due to the lack of testing and the experimental nature of this service.</p>
<p><img alt="brkers_connection" src="../img/suscripcion_brokers.png" /></p>
<h2 id="simulation-environment">Simulation Environment</h2>
<p>An environment has been created with docker compose that deploys in an isolated way (on two independent networks) the architectures <a href="https://fiware-tutorials.readthedocs.io/en/latest/getting-started.html">FIWARE NGSI-V2</a> and <a href="https://ngsi-ld-tutorials.readthedocs.io/en/latest/ngsi-ld-operations.html#architecture">FIWARE NGSI-LD</a>.</p>
<p><img alt="simulation_environment" src="../img/v2_LD_to_IoTAgent.png" /></p>
<h3 id="services">Services</h3>
<p>Grouping the services according to the network or networks they belong to, we have:</p>
<ul>
<li><strong>Network NGSI-V2</strong> <code>ngsiv2_network</code><ul>
<li><strong>IoT-Agent</strong> <code>ngsiv2.iotagent</code></li>
<li><strong>Mongo DB</strong> <code>ngsiv2.mongodb</code></li>
<li><strong>Orion-V2</strong> <code>ngsiv2.orionv2</code></li>
</ul>
</li>
<li><strong>Network NGSI-LD</strong> <code>ngsild_network</code><ul>
<li><strong>IoT-Agent</strong> <code>ngsild.iotagent</code></li>
<li><strong>Mongo DB</strong> <code>ngsild.mongodb</code></li>
<li><strong>LD Context</strong> <code>ngsild.context</code></li>
<li><strong>Orion-LD</strong> <code>ngsild.orionld</code></li>
<li><strong>Quantum Leap</strong> <code>ngsild.quantumleap</code>: Fiware data persistence service</li>
<li><strong>CreateDB</strong> <code>ngsild.cratedb</code>: DB for Quantum Leap.</li>
</ul>
</li>
<li><strong>Both networks</strong> <code>ngsiv2_network</code> y <code>ngsild_network</code><ul>
<li><strong>Jupyter Server</strong></li>
<li><strong>NGINX</strong></li>
</ul>
</li>
</ul>
<h2 id="before-continuing">Before continuing...</h2>
<h3 id="services-checks">Services checks</h3>
<h4 id="mongodb-connection">MongoDB connection</h4>
<p>A quick way to check that the environment is correctly deployed and the different services communicate with each other is to verify the different databases and collections through MongoDB Compass:</p>
<details class="example">
<summary>MongoDB Compass</summary>
<ul>
<li>
<p><strong>MongoDB-V2</strong>: <em>localhost</em>, port <code>27028</code></p>
<ul>
<li>IoT-Agent<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>DB</em>: <code>iotagent-json</code><ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>Colection</em>: <code>groups</code></li>
</ul>
</li>
</ul>
</li>
<li>Context Broker: The database will appear when it has some entity.</li>
</ul>
</li>
<li>
<p><strong>MongoDB-LD</strong>: <em>localhost</em>, port <code>27027</code></p>
<ul>
<li>IoT-Agent<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>DB</em>: <code>iotagent-json</code><ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>Colection</em>: <code>groups</code></li>
</ul>
</li>
</ul>
</li>
<li>Context Broker<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>DB</em>: <code>orionld</code><ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>Colection</em>: <code>contexts</code></li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>DB</em>: <code>myOrion</code><ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <em>Colection</em> <code>entities</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</details>
<h4 id="communication-with-the-iot-agents">Communication with the IoT-Agents</h4>
<p>By requesting the version from the IoT-Agents, it can be easily verified that they are correctly deployed and that they are visible among the different networks of the environment.</p>
<details class="example">
<summary>From <code>jupyter-server</code></summary>
<p>IoT-Agent NGSI-V2:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s1">&#39;http://ngsiv2.iotagent:4041/iot/about&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
<p>IoT-Agent NGSI-LD:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s1">&#39;http://ngsild.iotagent:4041/iot/about&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
</details>
<details class="example">
<summary>From <code>fiware-orionv2</code> to the IoT-Agent LD</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s1">&#39;http://ngsiv2.to-ngsild:4041/iot/about&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
</details>
<h3 id="terminal-access-to-the-containers">Terminal access to the containers</h3>
<p>To access the containers from the terminal, the command <code>docker exec</code> can be used.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-u<span class="w"> </span>&lt;usuario&gt;<span class="w"> </span>&lt;nombre_contenedor&gt;<span class="w"> </span>&lt;sh/bash&gt;
</span></code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="jupyter-server" name="__tabbed_1" type="radio" /><input id="fiware-orionv2" name="__tabbed_1" type="radio" /><input id="fiware-orionld" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="jupyter-server"><code>jupyter-server</code></label><label for="fiware-orionv2"><code>fiware-orionv2</code></label><label for="fiware-orionld"><code>fiware-orionld</code></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>orion-jupyter<span class="w"> </span>bash
</span></code></pre></div>
<ul>
<li>Access (by default): <code>root</code></li>
<li>Package installer: <code>apk</code></li>
</ul>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-u<span class="w"> </span>root<span class="w"> </span>fiware-orionv2<span class="w"> </span>bash
</span></code></pre></div>
<ul>
<li>Access (by default): <code>nobody</code></li>
<li>Package installer: <code>apt</code></li>
</ul>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>fiware-orionld<span class="w"> </span>bash
</span></code></pre></div>
<ul>
<li>Access (by default): <code>root</code></li>
<li>Package installer: <code>yum</code></li>
</ul>
</div>
</div>
</div>
</div>
<h3 id="steps-for-the-connection-between-brokers">Steps for the connection between brokers</h3>
<p>In theory, the procedure to connect two brokers through the IoT-Agent will be as follows:</p>
<ol>
<li>
<p>Provisioning of a service group (<em>IoT-Agent</em>)</p>
</li>
<li>
<p>Devices creation (<em>IoT-Agent</em>)</p>
</li>
<li>
<p>Subscription (<em>Context Broker</em>)</p>
</li>
<li>
<p>Modification of devices values (<em>IoT-Agent</em>)</p>
</li>
</ol>
<pre class="mermaid"><code>graph LR
    fir(1 - Provisioning\n of a service group) -.-&gt; A;
    sec(2 - Provisioning\n of a service group) -.-&gt; C;
    thi(3 - Custom\n subscription V2 to LD) -.-&gt; B;
    four(4 - Modification\n of devices values) -.-&gt; A;
    subgraph NGSI-V2
        A[IoT-Agent];
        A --- B[Orion Broker];
    end
    subgraph NGSI-LD
        B --&gt; C[IoT-Agent\n];
        C --- D[Orion Broker];
    end</code></pre>
<h2 id="simulations">Simulations</h2>
<h3 id="non-normalized-data-according-to-data-models">Non-normalized data according to <em>data-models</em></h3>
<p>The objective of this example is to show the procedure to connect two brokers, setting aside the use of <em>data-models</em> as a normalizing element.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Property</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Type</td>
<td style="text-align: left;"><code>example-type</code></td>
</tr>
<tr>
<td style="text-align: right;">fiware-service</td>
<td style="text-align: left;"><code>vrainIoTA</code></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">All the code shown is designed to be run from the <code>jupyter-server container</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>orion-jupyter<span class="w"> </span>bash
</span></code></pre></div>
</div>
<h4 id="provisioning-of-a-group-of-services-iot-agent">Provisioning of a group of services (<em>IoT-Agent</em>)</h4>
<p>Creation of a service in the <em>IoT-Agent</em> with the attributes that all devices belonging to this service will have.</p>
<div class="admonition tip">
<p class="admonition-title">Through <strong>services</strong>, sets of <strong>devices</strong> can be grouped together and the creation of these can be automated.</p>
</div>
<details class="note">
<summary>Editable fields (in both versions)</summary>
<ul>
<li><strong>URL</strong>: http://ngsiv2.iotagent:4041/iot/services</li>
<li><strong>Headers</strong>:<ul>
<li><strong>fiware-service</strong>: vrainIoTA</li>
<li><strong>fiware-servicepath</strong>: /</li>
</ul>
</li>
<li><strong>apikey</strong>: vrain2gpepnvsb2uv4s40d59ov (value <em>random</em>, in principle the main requirement is to maintain the length and characters).</li>
<li><strong>cbroker</strong>: http://ngsiv2.orion:1026</li>
<li><strong>entity_type</strong>: example-type</li>
<li><strong>attributes</strong>: Modify according to the attributes of the devices. The structure of: <code>object_id</code>, <code>name</code> and <code>type</code> <strong>must be maintained</strong>..</li>
</ul>
</details>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="curl-v2" name="__tabbed_2" type="radio" /><input id="curl-ld" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="curl-v2">cURL-V2</label><label for="curl-ld">cURL-LD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="s1">&#39;http://ngsiv2.iotagent:4041/iot/services&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>-d<span class="w"> </span><span class="s1">&#39;{</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="s1">    &quot;services&quot;: [</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="s1">        {</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="s1">            &quot;apikey&quot;:      &quot;vrain2gpepnvsb2uv4s40d59ov&quot;,</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="s1">            &quot;cbroker&quot;:     &quot;http://ngsiv2.orion:1026&quot;,</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="s1">            &quot;entity_type&quot;: &quot;example-type&quot;,</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="s1">            &quot;resource&quot;:    &quot;/iot/json&quot;,</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="s1">            &quot;attributes&quot;: [</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="s1">                {</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="s1">                    &quot;object_id&quot;: &quot;t&quot;,</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="s1">                    &quot;name&quot;: &quot;temperature&quot;,</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="s1">                },</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="s1">                {</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="s1">                    &quot;object_id&quot;: &quot;h&quot;,</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="s1">                    &quot;name&quot;: &quot;humidity&quot;,</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="s1">                },</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="s1">                {</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="s1">                    &quot;object_id&quot;: &quot;f&quot;,</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="s1">                    &quot;name&quot;: &quot;fillingLevel&quot;,</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="s1">                }</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="s1">            ]</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="s1">        }</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="s1">    ]</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="s1">}&#39;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="s1">&#39;http://ngsild.iotagent:4041/iot/services&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>-d<span class="w"> </span><span class="s1">&#39;{</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="s1">    &quot;services&quot;: [</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="s1">        {</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="s1">            &quot;apikey&quot;:      &quot;vrainld2gpnvsb2uv4s40d59ov&quot;,</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="s1">            &quot;cbroker&quot;:     &quot;http://ngsild.orion:1026&quot;,</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="s1">            &quot;entity_type&quot;: &quot;example-type&quot;,</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="s1">            &quot;resource&quot;:    &quot;/iot/json&quot;,</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="s1">            &quot;attributes&quot;: [</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="s1">                {</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="s1">                    &quot;object_id&quot;: &quot;t&quot;,</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="s1">                    &quot;name&quot;: &quot;temperature&quot;,</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="s1">                },</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="s1">                {</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="s1">                    &quot;object_id&quot;: &quot;h&quot;,</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="s1">                    &quot;name&quot;: &quot;humidity&quot;,</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="s1">                },</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="s1">                {</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="s1">                    &quot;object_id&quot;: &quot;f&quot;,</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="s1">                    &quot;name&quot;: &quot;fillingLevel&quot;,</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="s1">                    &quot;type&quot;: &quot;Number&quot;</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="s1">                }</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="s1">            ]</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="s1">        }</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="s1">    ]</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="s1">}&#39;</span>
</span></code></pre></div>
</div>
</div>
</div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>HTTP/1.1<span class="w"> </span><span class="m">201</span><span class="w"> </span>Created
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>X-Powered-By:<span class="w"> </span>Express
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Fiware-Correlator:<span class="w"> </span>c3e07e1c-62be-4ae4-8ee9-f112f585c077
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>Content-Type:<span class="w"> </span>application/json<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>Content-Length:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>ETag:<span class="w"> </span>W/<span class="s2">&quot;2-vyGp6PvFo4RvsFtPoIWeCReyIC8&quot;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">25</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">11</span>:39:01<span class="w"> </span>GMT
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>Keep-Alive:<span class="w"> </span><span class="nv">timeout</span><span class="o">=</span><span class="m">5</span>
</span></code></pre></div>
</details>
<div class="admonition info">
<p class="admonition-title">Result in MongoDB</p>
<p>It should appear within the <code>iotagent-json</code> database, a collection <code>groups</code> and within this as many documents as services have been created.</p>
</div>
<h5 id="checks">Checks</h5>
<p>The service groups can be obtained with the following request:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="curl-v2_1" name="__tabbed_3" type="radio" /><input id="curl-ld_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="curl-v2_1">cURL-V2</label><label for="curl-ld_1">cURL-LD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s1">&#39;http://ngsiv2.iotagent:4041/iot/services&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="o">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="s2">&quot;count&quot;</span>:<span class="w"> </span><span class="m">1</span>,
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="s2">&quot;services&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="o">{</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="s2">&quot;lazy&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="s2">&quot;attributes&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;t&quot;</span>,
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;temperature&quot;</span>,
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;h&quot;</span>,
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;humidity&quot;</span>,
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;f&quot;</span>,
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;fillingLevel&quot;</span>,
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">        </span><span class="o">}</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">    </span><span class="o">]</span>,
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">    </span><span class="s2">&quot;_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;653900b475ac594b1cc9e607&quot;</span>,
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">    </span><span class="s2">&quot;resource&quot;</span>:<span class="w"> </span><span class="s2">&quot;/iot/json&quot;</span>,
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">    </span><span class="s2">&quot;apikey&quot;</span>:<span class="w"> </span><span class="s2">&quot;vrain2gpepnvsb2uv4s40d59ov&quot;</span>,
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">    </span><span class="s2">&quot;service&quot;</span>:<span class="w"> </span><span class="s2">&quot;vrainiota&quot;</span>,
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">    </span><span class="s2">&quot;subservice&quot;</span>:<span class="w"> </span><span class="s2">&quot;/&quot;</span>,
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">    </span><span class="s2">&quot;__v&quot;</span>:<span class="w"> </span><span class="m">0</span>,
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="w">    </span><span class="s2">&quot;static_attributes&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="w">    </span><span class="s2">&quot;internal_attributes&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="w">    </span><span class="s2">&quot;entity_type&quot;</span>:<span class="w"> </span><span class="s2">&quot;example-type&quot;</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="o">]</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="o">}</span>
</span></code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s1">&#39;http://ngsild.iotagent:4041/iot/services&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="s2">&quot;count&quot;</span>:<span class="w"> </span><span class="m">1</span>,
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="s2">&quot;services&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="o">{</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="s2">&quot;lazy&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="s2">&quot;attributes&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;t&quot;</span>,
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;temperature&quot;</span>,
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;h&quot;</span>,
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;humidity&quot;</span>,
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">        </span><span class="s2">&quot;object_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;f&quot;</span>,
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w">        </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;fillingLevel&quot;</span>,
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">        </span><span class="s2">&quot;type&quot;</span>:<span class="w"> </span><span class="s2">&quot;Number&quot;</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">        </span><span class="o">}</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">    </span><span class="o">]</span>,
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">    </span><span class="s2">&quot;_id&quot;</span>:<span class="w"> </span><span class="s2">&quot;6540cb26101b6eba30d4d653&quot;</span>,
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">    </span><span class="s2">&quot;resource&quot;</span>:<span class="w"> </span><span class="s2">&quot;/iot/json&quot;</span>,
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">    </span><span class="s2">&quot;apikey&quot;</span>:<span class="w"> </span><span class="s2">&quot;vrainld2gpnvsb2uv4s40d59ov&quot;</span>,
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">    </span><span class="s2">&quot;service&quot;</span>:<span class="w"> </span><span class="s2">&quot;vrainiota&quot;</span>,
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="w">    </span><span class="s2">&quot;subservice&quot;</span>:<span class="w"> </span><span class="s2">&quot;/&quot;</span>,
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="w">    </span><span class="s2">&quot;__v&quot;</span>:<span class="w"> </span><span class="m">0</span>,
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="w">    </span><span class="s2">&quot;static_attributes&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">    </span><span class="s2">&quot;internal_attributes&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="w">    </span><span class="s2">&quot;entity_type&quot;</span>:<span class="w"> </span><span class="s2">&quot;example-type&quot;</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="o">]</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="o">}</span>
</span></code></pre></div>
</details>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Checklist - Before continuing...</p>
<p>To continue correctly with the example, you must have:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong>IoT-Agent V2</strong>: Having a service created.<ul>
<li>Take note (to use later) of the service's:<ul>
<li>Attributes.</li>
<li><code>apikey</code></li>
</ul>
</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> <strong>IoT-Agent LD</strong>: Having a service created.<ul>
<li>Take note (to use later) of the service's:<ul>
<li>Attributes.</li>
<li>`apikey</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h4 id="aprovisionamiento-de-dispositivos-iot-agent">Aprovisionamiento de dispositivos (<em>IoT-Agent</em>)</h4>
<p>The <em>creation</em> of devices can be done in two ways:</p>
<ul>
<li><strong>Manual</strong>: By explicitly creating a device.</li>
<li><strong>Automated</strong>: By using a service (previously created) and modifying the values of a device from the service.</li>
</ul>
<h5 id="manual-method">Manual Method</h5>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This section is not necessary for the correct operation of the example. It will only be necessary to know the <a href="#automated-method-through-services">automated method</a> to use it after creating the subscription and verifying that it works.</p>
</div>
<p>A specific device is added to the created service:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="curl-v2_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="curl-v2_2">cURL-V2</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="s1">&#39;http://ngsiv2.iotagent:4041/iot/devices&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>-d<span class="w"> </span><span class="s1">&#39;{</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="s1">    &quot;devices&quot;: [</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="s1">        {</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="s1">            &quot;device_id&quot;:   &quot;example001&quot;,</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="s1">            &quot;entity_name&quot;: &quot;example:example001&quot;,</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="s1">            &quot;entity_type&quot;: &quot;example-type&quot;,</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="s1">            &quot;timezone&quot;:    &quot;Europe/Madrid&quot;</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="s1">        }</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="s1">    ]</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="s1">}&#39;</span>
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>HTTP/1.1<span class="w"> </span><span class="m">201</span><span class="w"> </span>Created
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>X-Powered-By:<span class="w"> </span>Express
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>Fiware-Correlator:<span class="w"> </span>421f4048-f56d-423c-8868-088ae96965bf
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>Content-Type:<span class="w"> </span>application/json<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>Content-Length:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>ETag:<span class="w"> </span>W/<span class="s2">&quot;2-vyGp6PvFo4RvsFtPoIWeCReyIC8&quot;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">25</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">12</span>:10:10<span class="w"> </span>GMT
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>Keep-Alive:<span class="w"> </span><span class="nv">timeout</span><span class="o">=</span><span class="m">5</span>
</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>This process only adds a device in the IoT-Agent but does not modify the value of the attributes. To modify the device values, you must use the request of the <a href="#automated-method-through-services">automated method</a>.</p>
<h5 id="automated-method-through-services">Automated method (through <em>services</em>)</h5>
<p>This method fulfills two functions:</p>
<ul>
<li>Create a device (if it does not exist).</li>
<li>Modify the values of its attributes.</li>
</ul>
<details class="info">
<summary>URL Structure</summary>
<p>Replace the values of: <code>&lt;iotagent_adress&gt;</code>, <code>&lt;apikey&gt;</code> y <code>&lt;device_id&gt;</code> for the corresponding values.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>http://&lt;iotagent_adress&gt;:7896/iot/json?k<span class="o">=</span>&lt;apikey&gt;<span class="p">&amp;</span><span class="nv">i</span><span class="o">=</span>&lt;device_id&gt;
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The port for this request changes from <code>4041</code> to <code>7896</code>.</p>
</div>
</details>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="curl-v2_3" name="__tabbed_5" type="radio" /><input id="curl-ld_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="curl-v2_3">cURL-V2</label><label for="curl-ld_2">cURL-LD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="s1">&#39;http://ngsiv2.iotagent:7896/iot/json?k=vrain2gpepnvsb2uv4s40d59ov&amp;i=example001&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>-d<span class="w"> </span><span class="s1">&#39;{&quot;t&quot;: 1, &quot;h&quot;:20, &quot;f&quot;: 30}&#39;</span>
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>X-Powered-By:<span class="w"> </span>Express
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Content-Type:<span class="w"> </span>application/json<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Content-Length:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>ETag:<span class="w"> </span>W/<span class="s2">&quot;2-vyGp6PvFo4RvsFtPoIWeCReyIC8&quot;</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">25</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">12</span>:15:01<span class="w"> </span>GMT
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>Keep-Alive:<span class="w"> </span><span class="nv">timeout</span><span class="o">=</span><span class="m">5</span>
</span></code></pre></div>
</details>
</div>
<div class="tabbed-block">
<div class="admonition bug">
<p class="admonition-title">It does not work with versions higher than <code>2.3.0</code> of the IoT-Agent.</p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="s1">&#39;http://ngsiv2.to-ngsild:7896/iot/json?k=vrainld2gpnvsb2uv4s40d59ov&amp;i=example001&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>-d<span class="w"> </span><span class="s1">&#39;{&quot;t&quot;: 1, &quot;h&quot;:20, &quot;f&quot;: 30}&#39;</span>
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>Server:<span class="w"> </span>nginx/1.25.2
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">02</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">11</span>:35:07<span class="w"> </span>GMT
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>Content-Type:<span class="w"> </span>application/json<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>Content-Length:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>X-Powered-By:<span class="w"> </span>Express
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>ETag:<span class="w"> </span>W/<span class="s2">&quot;2-vyGp6PvFo4RvsFtPoIWeCReyIC8&quot;</span>
</span></code></pre></div>
</details>
</div>
</div>
</div>
<h6 id="checks_1">Checks</h6>
<p>To check the creation and modification of the values of a device, it can be done directly through MongoDB.</p>
<div class="admonition info">
<p class="admonition-title">Results in MongoDB</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="curl-v2_4" name="__tabbed_6" type="radio" /><input id="curl-ld_3" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="curl-v2_4">cURL-V2</label><label for="curl-ld_3">cURL-LD</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>As a result of this operation, a new database <code>orion-&lt;fiware-service&gt;</code> (orion-vrainiota) is created in mongodb with a <code>entities</code> collection and within this a document per device.</p>
</div>
<div class="tabbed-block">
<p>As a result of this operation, a new database <code>myOrion-&lt;fiware-service&gt;</code> (myOrion-vrainiota) is created in mongodb with a <code>entities</code> collection and within this a document per device.</p>
</div>
</div>
</div>
</div>
<h4 id="subscription-of-orion-context-broker-v2-to-the-iot-agent-ld">Subscription of Orion Context Broker V2 to the IoT-Agent LD</h4>
<p>Finally, a <em>custom</em> subscription is created in the V2 broker, in this way, for each modification of the values of a device, the broker will send a POST request (just like the <a href="#automated-method-through-services">previous one</a>) in an automated way.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="curl-brokerv2---iot-agent-ld" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="curl-brokerv2---iot-agent-ld">cURL (BrokerV2 -&gt; IoT-Agent LD)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition bug">
<p class="admonition-title">In the httpCustom:url, you cannot put addresses with <code>-</code></p>
</div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="s1">&#39;http://ngsiv2.orion:1026/v2/subscriptions&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-service: vrainIoTA&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>-H<span class="w"> </span><span class="s1">&#39;fiware-servicepath: /&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>-d<span class="w"> </span><span class="s1">&#39;{</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="s1">    &quot;description&quot;: &quot;Reenvo datos entre brokers.&quot;,</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="s1">    &quot;status&quot;: &quot;active&quot;,</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="s1">    &quot;subject&quot;: {</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="s1">        &quot;entities&quot;: [</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="s1">            {</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="s1">                &quot;idPattern&quot;: &quot;.*&quot;,</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="s1">                &quot;type&quot;: &quot;example-type&quot;</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="s1">            }</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="s1">        ],</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="s1">        &quot;condition&quot;: {</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="s1">            &quot;attrs&quot;: [],</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="s1">            &quot;notifyOnMetadataChange&quot;: true</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="s1">        }</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="s1">    },</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="s1">    &quot;notification&quot;: {</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="s1">        &quot;attrs&quot;: [],</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="s1">        &quot;onlyChangedAttrs&quot;: false,</span>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="s1">        &quot;attrsFormat&quot;: &quot;normalized&quot;,</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="s1">        &quot;httpCustom&quot;: {</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="s1">            &quot;url&quot;: &quot;http://ngsiv2.to-ngsild:7896/iot/json&quot;,</span>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="s1">            &quot;method&quot;: &quot;POST&quot;,</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="s1">            &quot;headers&quot;: {</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="s1">                &quot;Content-Type&quot;: &quot;application/json&quot;</span>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="s1">            },</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a><span class="s1">            &quot;qs&quot;: {</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="s1">                &quot;i&quot;: &quot;${id}&quot;,</span>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="s1">                &quot;k&quot;: &quot;vrainld2gpnvsb2uv4s40d59ov&quot;</span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a><span class="s1">            },</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a><span class="s1">            &quot;json&quot;: {</span>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a><span class="s1">                &quot;t&quot;: &quot;${temperature}&quot;,</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a><span class="s1">                &quot;h&quot;: &quot;${humidity}&quot;,</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a><span class="s1">                &quot;f&quot;: &quot;${fillingLevel}&quot;</span>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a><span class="s1">            }</span>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a><span class="s1">        }</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a><span class="s1">    }</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a><span class="s1">}&#39;</span>
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>HTTP/1.1<span class="w"> </span><span class="m">201</span><span class="w"> </span>Created
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">02</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">11</span>:56:13<span class="w"> </span>GMT
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Fiware-Correlator:<span class="w"> </span>d244b742-7976-11ee-8fe6-0242ac130005
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>Location:<span class="w"> </span>/v2/subscriptions/65438e5d0a524d42d10bffca
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>Content-Length:<span class="w"> </span><span class="m">0</span>
</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>Analyzing in detail some elements of this request we have:</p>
<ul>
<li><strong>URL</strong>: Points to the subscriptions of the V2 broker.</li>
<li><strong>fiware-service</strong>: Necessary for the subscription to work.</li>
<li><strong>fiware-servicepath</strong>: Necessary for the subscription to work.</li>
<li><strong>notification</strong><ul>
<li><strong>attrs</strong>: There is no need to specify attributes as they are later selected in the body of the request.</li>
<li><strong>httpCustom</strong><ul>
<li><strong>url</strong>: Points to the IoT-Agent LD. Since the V2 broker network does not have direct visibility to the LD network, this address points to the reverse proxy between both networks.</li>
<li><strong>qs</strong>: <ul>
<li><strong>k</strong>: The <code>k</code> parameter refers to the <strong><code>apiKey</code> of the service in IoT-Agent of LD</strong>.</li>
</ul>
</li>
<li><strong>json</strong>: This is the body of the request. It relates the <code>id</code> of the attributes in the IoT-Agent LD (<code>t</code>, <code>h</code> and <code>f</code>) with the attributes in the V2 broker (<code>${temperature}</code>, <code>${humidity}</code> and <code>${fillingLevel}</code>).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="checks_2">Checks</h5>
<p>To verify that the subscription is working, you simply need to modify the value of a device using the IoT-Agent or directly modify an attribute of an entity in the V2 broker. In this case, the first option is chosen through the IoT-Agent.</p>
<p>Note how the request points to the <strong>address of the IoT-Agent in V2</strong>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>curl<span class="w"> </span>-iX<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="s1">&#39;http://ngsiv2.iotagent:7896/iot/json?k=vrain2gpepnvsb2uv4s40d59ov&amp;i=example001&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>-d<span class="w"> </span><span class="s1">&#39;{&quot;t&quot;: 656, &quot;h&quot;:87, &quot;f&quot;: &quot;40&quot;}&#39;</span>
</span></code></pre></div>
<details class="note">
<summary>If everything goes well, we will receive a response like this:</summary>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>X-Powered-By:<span class="w"> </span>Express
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>Content-Type:<span class="w"> </span>application/json<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>Content-Length:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>ETag:<span class="w"> </span>W/<span class="s2">&quot;2-vyGp6PvFo4RvsFtPoIWeCReyIC8&quot;</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>Date:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">02</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">12</span>:31:00<span class="w"> </span>GMT
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>Connection:<span class="w"> </span>keep-alive
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>Keep-Alive:<span class="w"> </span><span class="nv">timeout</span><span class="o">=</span><span class="m">5</span>
</span></code></pre></div>
</details>
<p>After executing this request, we will observe how in MongoDB (both V2 and LD) the values of the device in question (<code>example001</code>) appear or are modified.</p>
<h2 id="references">References</h2>
<p><a href="https://github.com/FIWARE/tutorials.IoT-Agent-JSON">FIWARE IoT-Agent - Github</a> Each version (V2 or LD) is located in a different branch.</p>
<p><a href="https://github.com/telefonicaid/fiware-orion/blob/master/doc/manuals/orion-api.md#custom-notifications">FIWARE Docu. - API Custom Notificacions</a></p>
<p><a href="https://github.com/telefonicaid/fiware-orion/blob/master/doc/manuals/orion-api.md#subscriptionnotificationhttpcustom">FIWARE Docu. - API httpCustom</a></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-12-09T16:26:54+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-12-09</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-12-09T16:26:54+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-12-09</span>
  </span>

    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4Z"/></svg>
      
    </span>
    <nav>
      Joan Cipri
    </nav>
  </span>

    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../lepus/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lepus">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lepus
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../data_space_connectors/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="footer-container">
    <div class="footer-column">
        <div class="footer-logo">
            <a href="https://citcom.ai/" target="_blank">
                <img class="citcom-logo" src="/assets/citcom.svg" alt="CitCom.ai logo">
            </a>
            <a href="https://vrain.upv.es/" target="_blank">
                <img class="vrain-logo" src="/assets/vrain_white.png" alt="VRAIN logo">
            </a>
        </div>

    </div>
    <div class="footer-column">
        <div class="footer-tagline">
            <img src="/assets/eu-co-funded.png" alt="EU Logo">
            <p>
                Co-funded by the European Union. Views and opinions expressed are however those of the author(s)
                only and do not necessarily reflect those of the European Union. Neither the European Union nor the
                granting authority can be held responsible for them.
            </p>
        </div>
    </div>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "content.action.edit", "navigation.sections", "navigation.footer", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../../../js/timeago.min.js"></script>
      
        <script src="../../../../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>